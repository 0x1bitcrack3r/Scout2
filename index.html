<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Scout2 : Security auditing tool for AWS environments" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Scout2</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/iSECPartners/Scout2">View on GitHub</a>

          <h1 id="project_title">Scout2</h1>
          <h2 id="project_tagline">Security auditing tool for AWS environments</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/iSECPartners/Scout2/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/iSECPartners/Scout2/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h2>

<p>Using the AWS API, the Scout2 Python scripts fetches EC2, IAM, and S3, configuration data. The gathered configuration is analyzed and stored as JSON objects in several JavaScript files. These files are imported in the Scout2 HTML report, which allows for a quick and efficient review of the AWS configuration.</p>

<h2>
<a name="html-report" class="anchor" href="#html-report"><span class="octicon octicon-link"></span></a>HTML Report</h2>

<p>The Scout2 Python script populates JavaScript variables displayed in the HTML report. In addition to displaying the AWS configuration, the AWS Scout2 HTML report highlights high-risk areas automatically. Potential findings are highlight with two different colors</p>

<ul>
<li>red :: danger</li>
<li>orange :: warning</li>
</ul><h3>
<a name="ec2-view" class="anchor" href="#ec2-view"><span class="octicon octicon-link"></span></a>EC2 view</h3>

<p>Security Groups are the first layer of defense for EC2 instances (<a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Security.html#VPC_Security_Comparison">AWS documentation</a>), and control both inbound and outbound traffic at the instance level. AWS Scout2 has a default ruleset that reports known sensitive ports that are open to the Internet (in the following screenshot, 22/SSH). Additionally, the default ruleset also reports open ports whose number are associated with plaintext protocol (in the following screenshot, 23/Telnet).</p>

<p><img src="http://isecpartners.github.io/Scout2/images/aws-screenshot-ec2-sg.png" alt="EC2 Security Groups"></p>

<p>Network ACLs are the second layer of defense, and control traffic in and out of a subnet. AWS Scout2 has an EC2/Network ACLs view that reports all existing rules:</p>

<p><img src="http://isecpartners.github.io/Scout2/images/aws-screenshot-ec2-acls.png" alt="Network ACLs view"></p>

<h3>
<a name="iam-view" class="anchor" href="#iam-view"><span class="octicon octicon-link"></span></a>IAM view</h3>

<p>The IAM tab in the HTML report allows to review IAM users, groups and roles. In the following screenshot, AWS Scout2 reports two dangerous findings (lack of Multi-Factor Authentication, lack of access-key rotation), and warns about a third one (support for two types of authentication).</p>

<p><img src="http://isecpartners.github.io/Scout2/images/aws-screenshot-iam-user.png" alt="Apps"></p>

<h3>
<a name="s3-view" class="anchor" href="#s3-view"><span class="octicon octicon-link"></span></a>S3 view</h3>

<p>AWS Scout2 fetches the S3 configuration as well. The default ruleset highlights buckets that are world-writable, and whose permissions are world-writable. Additionally, a warning is displayed for world-readable buckets.</p>

<p><img src="http://isecpartners.github.io/Scout2/images/aws-screenshot-s3-worldwrite.png" alt="Apps"></p>

<h2>
<a name="default-rulesets" class="anchor" href="#default-rulesets"><span class="octicon octicon-link"></span></a>Default rulesets</h2>

<p>AWS Scout2 comes with the following, default, rulset:</p>

<h3>
<a name="ec2-default-ruleset" class="anchor" href="#ec2-default-ruleset"><span class="octicon octicon-link"></span></a>EC2 default ruleset</h3>

<table>
<thead><tr>
<th>Description</th>
<th>Level</th>
</tr></thead>
<tbody>
<tr>
<td>Sensitive port open to the Internet (e.g. SSH, RDP, SQL, ...)</td>
<td>danger</td>
</tr>
<tr>
<td>Plaintext-protocol port open (e.g. FTP, Telnet, ...)</td>
<td>danger</td>
</tr>
<tr>
<td>Non-HTTP ports open to the Internet (not 80/443)</td>
<td>warning</td>
</tr>
<tr>
<td>Lack of network ACLs (Inbound)</td>
<td>warning</td>
</tr>
<tr>
<td>Lack of network ACLs (Outbound)</td>
<td>warning</td>
</tr>
</tbody>
</table><h3>
<a name="iam-default-ruleset" class="anchor" href="#iam-default-ruleset"><span class="octicon octicon-link"></span></a>IAM default ruleset</h3>

<h3>
<a name="s3-default-ruleset" class="anchor" href="#s3-default-ruleset"><span class="octicon octicon-link"></span></a>S3 default ruleset</h3>

<h2>
<a name="how-to-create-a-new-rule" class="anchor" href="#how-to-create-a-new-rule"><span class="octicon octicon-link"></span></a>How to create a new rule</h2>

<ol>
<li>Open the default ruleset (under rules/findings-[XXX].default.rules) you wish to enhance, and create a new entry as follow:</li>
</ol><pre><code>+    },
+    "user-policy": {
+        "description": "User policies",
+        "entity": "users",
+        "callback": "hasUserPolicy",
+        "callback_args": "",
+        "level": "warning"
+    }
</code></pre>

<ol>
<li>Define and implement the new callback in the corresponding utils file:</li>
</ol><pre><code>+
+    def hasUserPolicy(self, key, obj):
+        if len(obj['policies']) &gt; 0:
+            self.addItem(obj['user_name'], obj['user_name'])
</code></pre>

<ol>
<li>Update the report.html to highlight thew new finding</li>
</ol><pre><code>-              &lt;h4 class="list-group-item-heading"&gt;User Policies &lt;spcan class="badge pull-right"&gt;{{count policies}}&lt;/span&gt;&lt;/h4&gt;
+              &lt;h4 class="list-group-item-heading"&gt;User Policies &lt;span class="badge pull-right" id="iam_users-user-policy-{{user_name}}"&gt;{{count policies}}&lt;/span&gt;&lt;/h4&gt;
</code></pre>

<h2>
<a name="authors-and-contributors" class="anchor" href="#authors-and-contributors"><span class="octicon octicon-link"></span></a>Authors and Contributors</h2>

<ul>
<li>Loic Simon - <a href="https://github.com/l01cd3v" class="user-mention">@l01cd3v</a>
</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Scout2 maintained by <a href="https://github.com/iSECPartners">iSECPartners</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
